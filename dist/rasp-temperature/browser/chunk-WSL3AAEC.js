import{a as te,d as re,f as N,h as c,k as D,l as L,n as g,q as P,r as j,s as q,t as T,u as B,v as V,w as oe}from"./chunk-VGUIS25Q.js";import{Ea as R,Fa as k,Ga as I,La as M,Pa as G,Qa as O,Ra as ie,ba as C,d as Y,ea as w,fa as b,i as Z,j as E,k as A,n as ee}from"./chunk-VKACNXDS.js";import{Db as a,Eb as t,Fb as v,Mb as y,Wb as n,Xb as u,Ya as s,Z as H,Za as p,cc as F,ea as _,jb as x,oa as X,sb as h,ub as l,ya as z,za as S}from"./chunk-SLHVZUCB.js";var ne=(()=>{let e=class e{constructor(i){this._raspberryConfigurationService=i,this.appName=this._raspberryConfigurationService.appName}};e.\u0275fac=function(o){return new(o||e)(p(ie))},e.\u0275cmp=_({type:e,selectors:[["app-login-container"]],standalone:!0,features:[F],decls:5,vars:1,consts:[[1,"w-screen","h-screen","flex","justify-center","items-center",2,"background-image","url('assets/images/login/login-background.jpg')","background-repeat","no-repeat","background-size","cover"],[1,"p-8"],["routerLink","/login",1,"text-xl","text-center","text-blue-800","font-bold","cursor-pointer"]],template:function(o,m){o&1&&(a(0,"div",0)(1,"mat-card",1)(2,"p",2),n(3),t(),v(4,"router-outlet"),t()()),o&2&&(s(3),u(m.appName()))},dependencies:[te,Z,A],encapsulation:2});let r=e;return r})();var $=(()=>{let e=class e{constructor(i,o){this._httpClient=i,this._authService=o}login(i,o){return this._httpClient.post(`${O}/login`,{email:i,password:o}).pipe(H(m=>{this._authService.user.set(m.data),this._authService.token=m.token}))}requestPasswordChange(i){return this._httpClient.post(`${O}/request-password-change`,{email:i})}changePassword(i,o,m){return this._httpClient.post(`${O}/change-password`,{email:i,new_email:i,recovery_token:o,new_password:m}).pipe(H(f=>{this._authService.user.set(f.data),this._authService.token=f.token}))}};e.\u0275fac=function(o){return new(o||e)(z(Y),z(ee))},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();function pe(r,e){if(r&1&&(a(0,"mat-error"),n(1),t()),r&2){let d=e.$implicit;s(),u(d)}}var ae=(()=>{let e=class e{constructor(i,o,m,f){this._loginService=i,this._formBuilder=o,this._notificationService=m,this._router=f,this.requestPasswordRecoverForm=this._formBuilder.group({email:new g("",[c.required,c.minLength(1),c.email])}),this._destroyRef=S(x)}requestPasswordRecover(){let i=this.requestPasswordRecoverForm.value;this._loginService.requestPasswordChange(i.email).pipe(b(this._destroyRef)).subscribe({next:()=>{this._notificationService.send(`Notificaci\xF3n enviada al correo ${i.email}`,"Revisa el correo para obtener el c\xF3digo de cambio de contrase\xF1a","success"),this._router.navigateByUrl("/login/password-recover?email="+i.email)},error:o=>{o.status==404&&this._notificationService.send("Este correo no est\xE1 registrado en esta plataforma",null,"error")}})}};e.\u0275fac=function(o){return new(o||e)(p($),p(q),p(G),p(E))},e.\u0275cmp=_({type:e,selectors:[["app-request-password-recover"]],standalone:!0,features:[F],decls:12,vars:4,consts:[[1,"flex","flex-col","gap-4",3,"formGroup"],[1,"text-center"],["matPrefix",""],["type","email","matInput","",3,"formControlName"],[4,"appFormError","appFormErrorFrom"],["mat-flat-button","","color","primary",3,"disabled","click"]],template:function(o,m){o&1&&(a(0,"div",0)(1,"h1",1),n(2,"Recuperar contrase\xF1a"),t(),a(3,"mat-form-field")(4,"mat-icon",2),n(5,"mail"),t(),a(6,"mat-label"),n(7,"Email"),t(),v(8,"input",3),h(9,pe,2,1,"mat-error",4),t(),a(10,"button",5),y("click",function(){return m.requestPasswordRecover()}),n(11,"Enviar correo de recuperaci\xF3n "),t()()),o&2&&(l("formGroup",m.requestPasswordRecoverForm),s(8),l("formControlName","email"),s(),l("appFormErrorFrom","email"),s(),l("disabled",m.requestPasswordRecoverForm.invalid))},dependencies:[C,M,w,B,R,I,T,N,D,L,P,j,V,k],encapsulation:2});let r=e;return r})();function ce(r,e){if(r&1&&(a(0,"mat-error"),n(1),t()),r&2){let d=e.$implicit;s(),u(d)}}function de(r,e){if(r&1&&(a(0,"mat-error"),n(1),t()),r&2){let d=e.$implicit;s(),u(d)}}var me=(()=>{let e=class e{constructor(i,o,m,f){this._loginService=i,this._formBuilder=o,this._router=m,this._notificationService=f,this.loginForm=this._formBuilder.group({email:new g("",[c.required,c.minLength(1),c.email]),password:new g("",[c.required,c.minLength(8)])}),this._destroyRef=S(x)}login(){let i=this.loginForm.value;this._loginService.login(i.email,i.password).pipe(b(this._destroyRef)).subscribe({next:()=>{this._router.navigateByUrl("/")},error:o=>{o.status===404?this._notificationService.send("Usuario o contrase\xF1a incorrectos",null,"error"):o.status===400&&this._notificationService.send("Formato incorrecto",null,"error")}})}};e.\u0275fac=function(o){return new(o||e)(p($),p(q),p(E),p(G))},e.\u0275cmp=_({type:e,selectors:[["app-login"]],standalone:!0,features:[F],decls:23,vars:6,consts:[[1,"flex","flex-col","gap-4",3,"formGroup"],[1,"text-center"],["matPrefix",""],["type","email","matInput","",3,"formControlName"],[4,"appFormError","appFormErrorFrom"],["type","password","matInput","",3,"formControlName"],["mat-flat-button","","color","primary",3,"disabled","click"],["routerLink","/login/request-password-recover",1,"text-center","text-blue-400","underline","mt-4"],["routerLink","/login/register",1,"text-center","text-blue-400","underline"]],template:function(o,m){o&1&&(a(0,"div",0)(1,"h1",1),n(2,"Login"),t(),a(3,"mat-form-field")(4,"mat-icon",2),n(5,"alternate_email"),t(),a(6,"mat-label"),n(7,"Email"),t(),v(8,"input",3),h(9,ce,2,1,"mat-error",4),t(),a(10,"mat-form-field")(11,"mat-icon",2),n(12,"password"),t(),a(13,"mat-label"),n(14,"Contrase\xF1a"),t(),v(15,"input",5),h(16,de,2,1,"mat-error",4),t(),a(17,"button",6),y("click",function(){return m.login()}),n(18,"Iniciar sesi\xF3n"),t(),a(19,"a",7),n(20,"Olvid\xE9 la contrase\xF1a"),t(),a(21,"a",8),n(22,"Registrarse"),t()()),o&2&&(l("formGroup",m.loginForm),s(8),l("formControlName","email"),s(),l("appFormErrorFrom","Email"),s(6),l("formControlName","password"),s(),l("appFormErrorFrom","Contrase\xF1a"),s(),l("disabled",m.loginForm.invalid))},dependencies:[C,M,w,B,R,I,A,T,N,D,L,P,j,V,k],encapsulation:2});let r=e;return r})();function ue(r,e){if(r&1&&(a(0,"mat-error"),n(1),t()),r&2){let d=e.$implicit;s(),u(d)}}function fe(r,e){if(r&1&&(a(0,"mat-error"),n(1),t()),r&2){let d=e.$implicit;s(),u(d)}}var se=(()=>{let e=class e{set token(i){this.passwordRecoverForm.patchValue({recovery_token:i})}constructor(i,o,m,f){this._formBuilder=i,this._loginService=o,this._notificationService=m,this._router=f,this._destroyRef=S(x),this.passwordRecoverForm=this._formBuilder.nonNullable.group({recovery_token:new g("",[c.required]),new_password:new g("",[c.required,c.minLength(8)])})}changePassword(){let i=this.passwordRecoverForm.value;this._loginService.changePassword(this.email,i.recovery_token,i.new_password).pipe(b(this._destroyRef)).subscribe({next:()=>{this._notificationService.send("Contrase\xF1a cambiada con \xE9xito",null,"success"),this._router.navigateByUrl("/")},error:()=>{this._notificationService.send("Ha ocurrido un error cambiando la contrase\xF1a",null,"error")}})}};e.\u0275fac=function(o){return new(o||e)(p(q),p($),p(G),p(E))},e.\u0275cmp=_({type:e,selectors:[["app-password-recover"]],inputs:{email:"email",token:"token"},standalone:!0,features:[F],decls:21,vars:5,consts:[[1,"flex","flex-col","gap-4",3,"formGroup"],[1,"text-center"],[1,"font-bold"],["type","text","matInput","","formControlName","recovery_token"],[4,"appFormError","appFormErrorFrom"],["matPrefix",""],["type","password","matInput","","formControlName","new_password"],["mat-flat-button","","color","primary",3,"disabled","click"]],template:function(o,m){o&1&&(a(0,"div",0)(1,"h1",1),n(2,"Recuperar contrase\xF1a"),t(),a(3,"p")(4,"span",2),n(5,"Email: "),t(),n(6),t(),a(7,"mat-form-field")(8,"mat-label"),n(9,"Token"),t(),v(10,"input",3),h(11,ue,2,1,"mat-error",4),t(),a(12,"mat-form-field")(13,"mat-icon",5),n(14,"password"),t(),a(15,"mat-label"),n(16,"Nueva contrase\xF1a"),t(),v(17,"input",6),h(18,fe,2,1,"mat-error",4),t(),a(19,"button",7),y("click",function(){return m.changePassword()}),n(20,"Cambiar contrase\xF1a "),t()()),o&2&&(l("formGroup",m.passwordRecoverForm),s(6),u(m.email),s(5),l("appFormErrorFrom","token"),s(7),l("appFormErrorFrom","contrase\xF1a"),s(),l("disabled",m.passwordRecoverForm.invalid))},dependencies:[C,M,w,B,R,I,V,k,T,N,D,L,P,j],encapsulation:2});let r=e;return r})();function ve(r,e){if(r&1&&(a(0,"mat-error"),n(1),t()),r&2){let d=e.$implicit;s(),u(d)}}function he(r,e){if(r&1&&(a(0,"mat-error"),n(1),t()),r&2){let d=e.$implicit;s(),u(d)}}function ge(r,e){if(r&1&&(a(0,"mat-error"),n(1),t()),r&2){let d=e.$implicit;s(),u(d)}}var le=(()=>{let e=class e{constructor(i,o,m,f){this._formBuilder=i,this._registerService=o,this._notificationService=m,this._router=f,this.registerForm=this._formBuilder.group({email:new g("",[c.required,c.minLength(1),c.email]),token:new g("",[c.required,c.minLength(1)]),password:new g("",[c.required,c.minLength(8)])}),this._destroyRef=S(x)}ngOnInit(){this.registerForm.patchValue({email:this.email,token:this.token})}register(){let i=this.registerForm.value;this._registerService.register(i.email,i.token,i.password).pipe(b(this._destroyRef)).subscribe({next:()=>{this._notificationService.send("Cuenta creada con \xE9xito",null,"success"),this._router.navigateByUrl("/")},error:()=>{this._notificationService.send("Ha ocurrido un fallo en el registro",null,"error")}})}};e.\u0275fac=function(o){return new(o||e)(p(q),p(oe),p(G),p(E))},e.\u0275cmp=_({type:e,selectors:[["app-register"]],inputs:{email:"email",token:"token"},standalone:!0,features:[F],decls:24,vars:5,consts:[[1,"flex","flex-col","gap-4",3,"formGroup"],[1,"text-center"],["matPrefix",""],["type","email","matInput","","formControlName","email"],[4,"appFormError","appFormErrorFrom"],["matTooltip","Token recibido por email con la invitaci\xF3n de un admin"],["type","token","matInput","","formControlName","token"],["type","password","matInput","","formControlName","password"],["mat-flat-button","","color","primary",3,"disabled","click"]],template:function(o,m){o&1&&(a(0,"div",0)(1,"h1",1),n(2,"Registro"),t(),a(3,"mat-form-field")(4,"mat-icon",2),n(5,"alternate_email"),t(),a(6,"mat-label"),n(7,"Email"),t(),v(8,"input",3),h(9,ve,2,1,"mat-error",4),t(),a(10,"mat-form-field",5)(11,"mat-label"),n(12,"Token"),t(),v(13,"input",6),h(14,he,2,1,"mat-error",4),t(),a(15,"mat-form-field")(16,"mat-icon",2),n(17,"password"),t(),a(18,"mat-label"),n(19,"Nueva contrase\xF1a"),t(),v(20,"input",7),h(21,ge,2,1,"mat-error",4),t(),a(22,"button",8),y("click",function(){return m.register()}),n(23,"Registrarse"),t()()),o&2&&(l("formGroup",m.registerForm),s(9),l("appFormErrorFrom","email"),s(5),l("appFormErrorFrom","token"),s(7),l("appFormErrorFrom","nueva contrase\xF1a"),s(),l("disabled",m.registerForm.invalid))},dependencies:[C,M,w,B,R,I,T,N,D,L,P,j,V,k,re],encapsulation:2});let r=e;return r})();var yt=[{path:"",component:ne,children:[{path:"",component:me},{path:"request-password-recover",component:ae},{path:"password-recover",component:se},{path:"register",component:le}]}];export{yt as LOGIN_ROUTES};
